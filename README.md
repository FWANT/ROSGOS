По идее - настройка правила в Outlook для импорта файлов и текста сообщения с .xml
Далее - парсинг файла на определение агента (можно брать из текста сообщения, но могут скосячить), а при парсинге просто не найдётся такой агент
Далее - заход в нужную базу, открытие загрузчика (можно будет сделать без захода в базу), автоматический ввод нужных параметров, проверка автоматических значений, подтверждение на загрузку, проверка загрузки и выдача сообщения.
При отлаженной процедуре можно сделать всё в скрытом окне с откидыванием багов в логи и сообщением о них.
